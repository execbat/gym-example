[2024-08-09 19:34:56,464][05362] Saving configuration to /home/evgenii/Documents/Jupyter_notebooks/SAMPLE_FACTORY/TRADER_PROJECT/train_dir/example_gymnasium_trader/config.json...
[2024-08-09 19:34:56,473][05362] Rollout worker 0 uses device cpu
[2024-08-09 19:34:56,473][05362] Rollout worker 1 uses device cpu
[2024-08-09 19:34:56,473][05362] Rollout worker 2 uses device cpu
[2024-08-09 19:34:56,473][05362] Rollout worker 3 uses device cpu
[2024-08-09 19:34:56,474][05362] Rollout worker 4 uses device cpu
[2024-08-09 19:34:56,474][05362] Rollout worker 5 uses device cpu
[2024-08-09 19:34:56,474][05362] Rollout worker 6 uses device cpu
[2024-08-09 19:34:56,474][05362] Rollout worker 7 uses device cpu
[2024-08-10 20:46:02,971][05508] Saving configuration to /home/evgenii/Documents/Jupyter_notebooks/SAMPLE_FACTORY/TRADER_PROJECT/train_dir/example_gymnasium_trader/config.json...
[2024-08-10 20:46:02,980][05508] Rollout worker 0 uses device cpu
[2024-08-10 20:46:02,980][05508] Rollout worker 1 uses device cpu
[2024-08-10 20:46:02,980][05508] Rollout worker 2 uses device cpu
[2024-08-10 20:46:02,980][05508] Rollout worker 3 uses device cpu
[2024-08-10 20:46:02,980][05508] Rollout worker 4 uses device cpu
[2024-08-10 20:46:02,980][05508] Rollout worker 5 uses device cpu
[2024-08-10 20:46:02,981][05508] Rollout worker 6 uses device cpu
[2024-08-10 20:46:02,981][05508] Rollout worker 7 uses device cpu
[2024-08-10 21:12:25,538][06630] Saving configuration to /home/evgenii/Documents/Jupyter_notebooks/SAMPLE_FACTORY/TRADER_PROJECT/train_dir/example_gymnasium_trader/config.json...
[2024-08-10 21:12:25,551][06630] Rollout worker 0 uses device cpu
[2024-08-10 21:12:25,551][06630] Rollout worker 1 uses device cpu
[2024-08-10 21:12:25,551][06630] Rollout worker 2 uses device cpu
[2024-08-10 21:12:25,551][06630] Rollout worker 3 uses device cpu
[2024-08-10 21:12:25,551][06630] Rollout worker 4 uses device cpu
[2024-08-10 21:12:25,551][06630] Rollout worker 5 uses device cpu
[2024-08-10 21:12:25,551][06630] Rollout worker 6 uses device cpu
[2024-08-10 21:12:25,552][06630] Rollout worker 7 uses device cpu
[2024-08-10 21:12:25,573][06630] Using GPUs [0] for process 0 (actually maps to GPUs [0])
[2024-08-10 21:12:25,573][06630] InferenceWorker_p0-w0: min num requests: 1
[2024-08-10 21:12:25,575][06630] Using GPUs [0] for process 0 (actually maps to GPUs [0])
[2024-08-10 21:12:25,576][06630] InferenceWorker_p0-w1: min num requests: 1
[2024-08-10 21:12:25,591][06630] Starting all processes...
[2024-08-10 21:12:25,591][06630] Starting process learner_proc0
[2024-08-10 21:12:25,857][06630] Starting all processes...
[2024-08-10 21:12:25,862][06630] Starting process inference_proc0-0
[2024-08-10 21:12:25,863][06630] Starting process inference_proc0-1
[2024-08-10 21:12:25,865][06630] Starting process rollout_proc0
[2024-08-10 21:12:25,868][06630] Starting process rollout_proc1
[2024-08-10 21:12:25,874][06630] Starting process rollout_proc2
[2024-08-10 21:12:25,877][06630] Starting process rollout_proc3
[2024-08-10 21:12:25,878][06630] Starting process rollout_proc4
[2024-08-10 21:12:25,880][06630] Starting process rollout_proc5
[2024-08-10 21:12:25,881][06630] Starting process rollout_proc6
[2024-08-10 21:12:25,881][06630] Starting process rollout_proc7
[2024-08-10 21:12:27,530][06687] Worker 1 uses CPU cores [1]
[2024-08-10 21:12:27,610][06697] Worker 4 uses CPU cores [4]
[2024-08-10 21:12:27,687][06696] Worker 3 uses CPU cores [3]
[2024-08-10 21:12:27,690][06714] Worker 6 uses CPU cores [6]
[2024-08-10 21:12:27,710][06684] Using GPUs [0] for process 0 (actually maps to GPUs [0])
[2024-08-10 21:12:27,710][06684] Set environment var CUDA_VISIBLE_DEVICES to '0' (GPU indices [0]) for inference process 0
[2024-08-10 21:12:27,744][06670] Using GPUs [0] for process 0 (actually maps to GPUs [0])
[2024-08-10 21:12:27,744][06670] Set environment var CUDA_VISIBLE_DEVICES to '0' (GPU indices [0]) for learning process 0
[2024-08-10 21:12:27,772][06670] Num visible devices: 1
[2024-08-10 21:12:27,783][06684] Num visible devices: 1
[2024-08-10 21:12:27,822][06686] Using GPUs [0] for process 0 (actually maps to GPUs [0])
[2024-08-10 21:12:27,822][06686] Set environment var CUDA_VISIBLE_DEVICES to '0' (GPU indices [0]) for inference process 0
[2024-08-10 21:12:27,826][06670] Starting seed is not provided
[2024-08-10 21:12:27,826][06670] Using GPUs [0] for process 0 (actually maps to GPUs [0])
[2024-08-10 21:12:27,826][06670] Initializing actor-critic model on device cuda:0
[2024-08-10 21:12:27,827][06670] RunningMeanStd input shape: (4, 3)
[2024-08-10 21:12:27,829][06670] RunningMeanStd input shape: (1,)
[2024-08-10 21:12:27,839][06670] ConvEncoder: input_channels=4
[2024-08-10 21:12:27,850][06686] Num visible devices: 1
[2024-08-10 21:12:27,854][06670] EvtLoop [learner_proc0_evt_loop, process=learner_proc0] unhandled exception in slot='init' connected to emitter=Emitter(object_id='Runner_EvtLoop', signal_name='start'), args=()
Traceback (most recent call last):
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/signal_slot/signal_slot.py", line 355, in _process_signal
    slot_callable(*args)
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/sample_factory/algo/learning/learner_worker.py", line 139, in init
    init_model_data = self.learner.init()
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/sample_factory/algo/learning/learner.py", line 212, in init
    self.actor_critic = create_actor_critic(self.cfg, self.env_info.obs_space, self.env_info.action_space)
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/sample_factory/model/actor_critic.py", line 296, in create_actor_critic
    return make_actor_critic_func(cfg, obs_space, action_space)
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/sample_factory/model/actor_critic.py", line 286, in default_make_actor_critic_func
    return ActorCriticSharedWeights(model_factory, obs_space, action_space, cfg)
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/sample_factory/model/actor_critic.py", line 141, in __init__
    self.encoder = model_factory.make_model_encoder_func(cfg, obs_space)
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/sample_factory/model/encoder.py", line 242, in default_make_encoder_func
    return MultiInputEncoder(cfg, obs_space)
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/sample_factory/model/encoder.py", line 51, in __init__
    self.encoders[obs_key] = encoder_fn(cfg, obs_space[obs_key])
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/sample_factory/model/encoder.py", line 227, in make_img_encoder
    return ConvEncoder(cfg, obs_space)
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/sample_factory/model/encoder.py", line 140, in __init__
    enc = ConvEncoderImpl(obs_space.shape, conv_filters, extra_mlp_layers, activation)
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/sample_factory/model/encoder.py", line 112, in __init__
    self.conv_head_out_size = calc_num_elements(self.conv_head, obs_shape)
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/sample_factory/algo/utils/torch_utils.py", line 39, in calc_num_elements
    num_elements = module(some_input).numel()
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/evgenii/anaconda3/envs/sample_factory/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [32, 4, 8, 8], expected input[1, 1, 4, 3] to have 4 channels, but got 1 channels instead
[2024-08-10 21:12:27,857][06670] Unhandled exception Given groups=1, weight of size [32, 4, 8, 8], expected input[1, 1, 4, 3] to have 4 channels, but got 1 channels instead in evt loop learner_proc0_evt_loop
[2024-08-10 21:12:27,890][06705] Worker 5 uses CPU cores [5]
[2024-08-10 21:12:28,021][06688] Worker 2 uses CPU cores [2]
[2024-08-10 21:12:28,130][06685] Worker 0 uses CPU cores [0]
[2024-08-10 21:12:28,166][06706] Worker 7 uses CPU cores [7]
